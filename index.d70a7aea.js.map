{"mappings":"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","sources":["src/js/index.js"],"sourcesContent":["import { createMovieModalMarkup, createMoviesMarkup } from './renderMarkup';\nimport { fetchMovieByID, fetchMovies } from './tmdb-api';\n\n// Seleccion elementos DOM\nconst heroForm = document.querySelector('form.hero__form');\nconst movieCards = document.querySelector('ul.movie-cards__list');\nconst paginationAddBtn = document.querySelector('button.pagination__add');\nconst paginationSubBtn = document.querySelector('button.pagination__sub');\nconst paginationSpan = document.querySelector('span.pagination__span');\nconst backdropModal = document.querySelector('div.backdrop');\nconst closeModal = document.querySelector('.modal__btn');\nconst modalMovie = document.querySelector('.modal-movie');\nconst addWatched = document.querySelector('.watched');\nconst addQueue = document.querySelector('.queue');\nconst loader = document.querySelector('.loader');\n\n// Variables\nlet page = 1;\nlet totalPages;\nlet query;\nlet selectedMovie = null;\nloader.style.display = 'none';\n// Iniciar estos array como estado. si los defino [] cada vez que haga push al array iniciara desde 0. Pero si cargo el localStorage por defecto entonces las peliculas se iran guardadando en el array de manera correcta.\nconst watchedArray = JSON.parse(localStorage.getItem('watchedArray')) || [];\nconst queueArray = JSON.parse(localStorage.getItem('queueArray')) || [];\n\n// Funciones\nconst toogleModal = isVisible => {\n  if (isVisible) {\n    backdropModal.classList.add('visible');\n  } else {\n    backdropModal.classList.remove('visible');\n  }\n};\n\nconst renderInitialMovies = async () => {\n  const searchRoute = 'movie/popular?';\n  const searchParams = new URLSearchParams({\n    page,\n  });\n  renderFetchMovies(searchRoute, searchParams);\n};\n\nconst renderFetchMovies = async (searchRoute, searchParams) => {\n  movieCards.innerHTML = '';\n  try {\n    const moviesData = await fetchMovies(searchRoute, searchParams);\n    totalPages = moviesData.total_pages;\n    const movies = moviesData.results;\n    if (movies.length > 0) {\n      createMoviesMarkup(movies, movieCards);\n    } else {\n      console.log('Error');\n      loader.style.display = 'block';\n    }\n  } catch (error) {\n    console.log(error.message);\n  }\n};\n\n// Manejadores de eventos\nconst handleSubmit = async e => {\n  e.preventDefault();\n  page = 1;\n  paginationSpan.textContent = 1;\n  movieCards.innerHTML = '';\n\n  const form = e.target;\n  query = form.elements.movieInput.value;\n  const searchRoute = 'search/movie?';\n\n  const searchParams = new URLSearchParams({\n    query,\n    page,\n  });\n\n  renderFetchMovies(searchRoute, searchParams);\n\n  form.reset();\n};\n// Paginacion\nconst handleAddPage = () => {\n  if (page < totalPages) {\n    page += 1;\n    paginationSpan.textContent = page;\n    const searchParams = new URLSearchParams({\n      page,\n    });\n\n    if (query) {\n      searchParams.set('query', query);\n    }\n\n    const currentRoute = query ? 'search/movie?' : 'movie/popular?';\n    renderFetchMovies(currentRoute, searchParams);\n  }\n};\n\nconst handleSubPage = () => {\n  if (page > 1) {\n    page -= 1;\n    paginationSpan.textContent = page;\n    const searchParams = new URLSearchParams({\n      page,\n    });\n\n    if (query) {\n      searchParams.set('query', query);\n    }\n\n    const currentRoute = query ? 'search/movie?' : 'movie/popular?';\n    renderFetchMovies(currentRoute, searchParams);\n  }\n};\n\n// Manipulacion y exportacion de datos de la tarjeta elegida y Modal.\nconst handleSelectCard = async e => {\n  // Busca el ancestro m√°s cercano que sea un <li> con la clase movie-cards__item.\n  const card = e.target.closest('li.movie-cards__item');\n  if (card) {\n    toogleModal(true);\n    modalMovie.innerHTML = '';\n    try {\n      const movie = await fetchMovieByID(card.id);\n      selectedMovie = movie;\n      createMovieModalMarkup(movie, modalMovie);\n    } catch (error) {\n      console.log(error.message);\n    }\n  }\n};\n\nconst handleCloseModal = e => {\n  const closeBtn = e.target.closest('button.modal__btn');\n  if (closeBtn) {\n    toogleModal(false);\n  }\n};\n\nconst handleAddWatched = e => {\n  if (selectedMovie) {\n    watchedArray.push(selectedMovie);\n    const watchedArrayJSON = JSON.stringify(watchedArray);\n    localStorage.setItem('watchedArray', watchedArrayJSON);\n  }\n};\n\nconst handleAddQueue = e => {\n  if (selectedMovie) {\n    queueArray.push(selectedMovie);\n    const queueArrayJSON = JSON.stringify(queueArray);\n    localStorage.setItem('queueArray', queueArrayJSON);\n  }\n};\n\n// Eventos\nheroForm.addEventListener('submit', handleSubmit);\npaginationAddBtn.addEventListener('click', handleAddPage);\npaginationSubBtn.addEventListener('click', handleSubPage);\nmovieCards.addEventListener('click', handleSelectCard);\ncloseModal.addEventListener('click', handleCloseModal);\naddWatched.addEventListener('click', handleAddWatched);\naddQueue.addEventListener('click', handleAddQueue);\n// Inicializacion\nrenderInitialMovies();\n"],"names":["$cky31","parcelRequire","$85a5f86b715fe7db$var$heroForm","document","querySelector","$85a5f86b715fe7db$var$movieCards","$85a5f86b715fe7db$var$paginationAddBtn","$85a5f86b715fe7db$var$paginationSubBtn","$85a5f86b715fe7db$var$paginationSpan","$85a5f86b715fe7db$var$backdropModal","$85a5f86b715fe7db$var$closeModal","$85a5f86b715fe7db$var$modalMovie","$85a5f86b715fe7db$var$addWatched","$85a5f86b715fe7db$var$addQueue","$85a5f86b715fe7db$var$loader","$85a5f86b715fe7db$var$totalPages","$85a5f86b715fe7db$var$query","$85a5f86b715fe7db$var$page","$85a5f86b715fe7db$var$selectedMovie","style","display","$85a5f86b715fe7db$var$watchedArray","JSON","parse","localStorage","getItem","$85a5f86b715fe7db$var$queueArray","$85a5f86b715fe7db$var$toogleModal","isVisible","classList","add","remove","$85a5f86b715fe7db$var$renderFetchMovies","async","searchRoute","searchParams","innerHTML","moviesData","$9MaFa","fetchMovies","total_pages","movies","results","length","createMoviesMarkup","console","log","error","message","addEventListener","e","preventDefault","textContent","form","target","elements","movieInput","value","URLSearchParams","reset","set","card","closest","movie","fetchMovieByID","id","createMovieModalMarkup","push","watchedArrayJSON","stringify","setItem","queueArrayJSON","$85a5f86b715fe7db$var$renderInitialMovies"],"version":3,"file":"index.d70a7aea.js.map"}